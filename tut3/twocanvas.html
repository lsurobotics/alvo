<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Mobile robot programming.</title>
  <link rel="stylesheet" href="../lib/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="../css/style.css">
  <script src="../lib/bootstrap/jquery.min.js"></script>
  <script src="../lib/bootstrap/bootstrap.bundle.min.js"></script>
  <script src="../lib/anime/anime.min.js"></script>
</head>
<body>
  <!-- HTML Elements -->
  <div class="taskcontainer">
    <h4>Tutorial 3: Editing and Re-using Blocks</h4>
      <div id="steps" style="grid-column-end: span 4">
        <p>Task:</p>
        <ol>
          <li>Move the yellow box <img src="../media/item-yellow.png" style="height:20px; width:20px"> from the left side of Station A to the right side <strong>and turn it upside-down</strong>.</li>
          <li>Move the blue box <img src="../media/item-blue.png" style="height:20px; width:20px"> from the left side of Station B to the right side <strong>and turn it upside-down</strong>.</li>
          <li>Move the orange box <img src="../media/item-orange.png" style="height:20px; width:20px"> from the left side of Station C to the right side, on top of the green box, <strong>and turn it upside-down</strong>.</li>
        </ol>
        <p>As you have seen in the previous tutorial, robot programs are often very similar to each other. It can therefore be useful to use existing code rather than writing all programs from scratch.</p>
        <p>The goal of this tutorial is similar to the previous one, and you could solve it like you did before, but we will use a different method to program this time. You can click on each step to get more detailed instructions.</p>
        <ol class="accordion-group">
          <li><a href="#step1" data-toggle="collapse">Re-use the first task</a>
            <ol id="step1" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>Open the <img src="tasksmenu.png" style="height:22px; border: solid 1px #333"> menu below.</li>
              <li>Instead of creating a new task, drag the existing task onto the canvas and attach it to the very bottom of the program.</li>
              <li>Assign the new block to "Station B" using the <img src="stationmenu.png" style="height:22px"> menu.</li>
              <li>Before you continue, take a moment to understand what the current program does. Click the <img src="runprogram.png" style="height:30px; margin:1px"> button underneath the simulator to try it out. As you can see, both tasks execute the same commands at different station.</li>
            </ol>
          </li>
          <li><a href="#step2" data-toggle="collapse">Turn the box upside-down at both stations</a>
            <ol id="step2" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>Open the <img src="armmenu.png" style="height:22px; border: solid 1px #333"> menu in the task editor and drag the <img src="turnblock.png" style="height:30px"> block onto the canvas. The robot can only turn blocks that it is currently holding, so the new block has to be placed right after the <img src="pickupblock.png" style="height:30px"> block.</li>
              <li>Drag another <img src="turnblock.png" style="height:30px"> block from the <img src="armmenu.png" style="height:22px; border: solid 1px #333"> menu onto the canvas and place it right after the one you just added.</li>
              <li>Before you continue, take another moment to understand what the current program does and try it out by resetting the simulator and then clicking the <img src="runprogram.png" style="height:30px; margin:1px"> button again. As you can see, your changes have affected all places where the same task is used, in this case both station A and B.</li>
            </ol>
          </li>
          <li><a href="#step3" data-toggle="collapse">Save time by re-using the first task again</a>
            <ol id="step3" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>Since the third part of the task is also similar to the previous ones, you can use the existing code as a starting point instead of creating a new task. <strong>However, you need to create a duplicate of that task first so that your changes don't affect the other stations.</strong></li>
              <li>To create a duplicate of a task, right-click on it in the left editor and select <img src="duplicate.png" style="height:28px; border: solid 1px #333">. A new task block should appear next to the existing one.</li>
              <li>Attach the new task block to the very bottom of the program. Give the new block a descriptive name, such as "Move stacked box to the right", and assign it to "Station C" using the <img src="stationmenu.png" style="height:22px"> menu.</li>
            </ol>
          </li>
          <li><a href="#step4" data-toggle="collapse">Change the locations for station C</a>
            <ol id="step4" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>Make sure you have selected the new task for station C in the left canvas. Notice how this task already contains the same commands as the original task and can be the starting point for programming station C. </li>
              <li>Open the <img src="locationmenu.png" style="height:22px; border: solid 1px #333"> menu and select <img src="definelocation.png" style="height:22px; margin:1px;">. Select the <strong>middle left</strong> location and drag it onto the canvas.</li>
              <li>Attach the "middle left" location you just created to the <img src="pickupblock.png" style="height:30px; margin:1px;"> block, replacing the "bottom left" block. You can delete the leftover "bottom left" block by dragging it onto the trash can symbol if you want.</li>
              <li>Repeat the previous steps and define another new location at the <strong>middle right</strong>. Attach it to the <img src="placeblock.png" style="height:30px"> block, replacing the "bottom right" block. Again, you can delete the leftover block if you want.</li>
            </ol>
          </li>
          <li><a href="#step5" data-toggle="collapse">Test the program</a>
            <ol id="step5" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>You have successfully programmed the entire task. Test your solution by clicking the button below. Watch how the robot executes each step of the program. Notice how the programs for stations A and B were not affected by editing the duplicated task.</li>
            </ol>
          </li>
        </ol>
      <button id="test-button" value="start-test" type="button" class="btn btn-success">Test Current Program</button>
      <span id="task-fail">Task not completed! Please go back and make sure you followed all the steps correctly.</span>
      <span id="task-success">Task completed! Congratulations, you've successfully re-used programs for multiple stations!</span>
    </div>
  </div>
  <div class="maincontainer twocanvas">
    <div id="leftdiv" class="workspace"></div>
    <div id="middlediv" class="workspace">
      <div id="animatediv" style="margin-left: 0px">
        <div id="stackedRest">
          <div id="stackedDummyDrawer"></div>
        </div>
        <div id="__Move box to the rightdiv" class="workspace" style="position: relative;"></div>
      </div>
    </div>
    <div id="rightdiv">
      <div id="simulatorarea">
      <div id="simulatordiv"></div>
      <button id="execution-button" value="start-execution" type="button" class="btn btn-success">Run Program</button>
      <button id="reset-button" value="reset-simulator" type="button" class="btn btn-secondary">Reset Simulator</button>
      </div>
    </div>
    <div id="output">
    </div>
    <div id="simbuttons">
    </div>
  </div>

  <!-- Starting configuration -->
  <xml xmlns="https://developers.google.com/blockly/xml" id="workspaceBlocks" style="display: none">
      <variables>
      <variable id="Move box to the right">Move box to the right</variable></variables>
      <block type="custom_start" id="START" x="28" y="28"><next><block type="custom_task"><field name="TASK">Move box to the right</field><field name="SITE">STATIONA</field></block></next></block></xml>
  </xml>

  <xml xmlns="https://developers.google.com/blockly/xml" id="rightWorkspaceBlocks" style="display: none">
    <variables>
      <variable id="bottom left">bottom left</variable>
      <variable id="bottom right">bottom right</variable>
    </variables>
    <block type="custom_taskheader" deletable="false" x="28" y="28"><field name="TASK">Move box to the right</field><field name="SITE">STATIONA</field><next><block type="custom_pickup"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">bottom left</field></block></value><next><block type="custom_place"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">bottom right</field></block></value></next></block></next></block></next></block>
  </xml>

  <xml xmlns="https://developers.google.com/blockly/xml" id="toolboxLeft" style="display: none">
    <category name="Tasks" colour="#5C9FA6" custom="TASKS">
    </category>
  </xml>

  <xml xmlns="https://developers.google.com/blockly/xml" id="toolboxRight" style="display: none">
    <category name="Arm" colour="#968e4f">
      <block type="custom_pickup">
        <value name="LOCATION">
          <shadow type="custom_dummylocation">
          </shadow>
        </value>
      </block>
      <block type="custom_place">
        <value name="LOCATION">
          <shadow type="custom_dummylocation">
          </shadow>
        </value>
      </block>
      <block type="custom_turn">
      </block>
    </category>
    <category name="Locations" colour="#A08260" custom="LOCATIONS">
    </category>
  </xml>

  <!-- Javascript Code -->
  <script src="../blockly/blockly_uncompressed.js"></script>
  <script src="../blockly/blocks_compressed.js"></script>
  <script src="../blockly/javascript_compressed.js"></script>
  <script src="task.js"></script>
  <script src="../js/generator.js"></script>
  <script src="../blockly/msg/js/en.js"></script>
  <script src="../js/blocks.js"></script>
  <script src="../js/index.js"></script>
  <script src="../js/twocanvas.js"></script>
  <script src="../js/simulator.js"></script>
  <script src="../js/defposition.js"></script>
</body>
</html>