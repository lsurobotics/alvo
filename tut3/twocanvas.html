<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Mobile robot programming.</title>
  <link rel="stylesheet" href="../lib/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="../css/style.css">
  <script src="../lib/bootstrap/jquery.min.js"></script>
  <script src="../lib/bootstrap/bootstrap.bundle.min.js"></script>
  <script src="../lib/anime/anime.min.js"></script>
</head>
<body>
  <!-- HTML Elements -->
  <div class="taskcontainer">
    <h4>Tutorial 3: Editing and Re-using Code</h4>
    <div>
    <p>Task:</p>
      <ol>
        <li>Move all the green boxes <img src="../media/item-green.png" style="height:20px; width:20px"> from the left side of Station A to the right side.</li>
        <li>Move all the orange boxes <img src="../media/item-orange.png" style="height:20px; width:20px"> from the left side of Station B to the right side.</li>
        <li>Move all the yellow boxes <img src="../media/item-yellow.png" style="height:20px; width:20px"> from the left side of Station C to the right side and turn each of them twice, so that they are upside-down <img src="../media/item-yellow.png" style="height:20px; width:20px; transform:rotate(180deg)">.</li>
      </ol>
        <p>As you have seen in the previous tutorial, robot programs are often very similar to each other. It can therefore be useful to use existing code rather than writing all programs from scratch.</p>
        <p>In this tutorial, we ask you to solve a task that benefits significantly from re-using existing code, and we will show you how to solve it in a smart way. You can click on each step to get more detailed instructions.</p>
        <ol class="accordion-group">
          <li><a href="#step1" data-toggle="collapse">Look at the existing program</a>
            <ol id="step1" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>For this task, we have given you a small program to start with. Click on the <img src="movestack.png" style="height:30px; margin: 1px"> task block below to look at the given code in detail.</li>
              <li>This code will pick up blocks from the left side of a station and move them to the right side of the station. Before you continue, take a moment to understand what the current program does. Click the <img src="runprogram.png" style="height:30px; margin:1px"> button underneath the simulator to try it out.</li>
              <li>As you can see, the given program already solves step 1 of the given task by moving all the green boxes <img src="../media/item-green.png" style="height:20px; width:20px"> into their intended positions.</li>

            </ol>
          </li>
          <li><a href="#step2" data-toggle="collapse">Re-use the existing program</a>
            <ol id="step2" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>You might have noticed that step 2 of the given task is very similar to step 1. In fact, you can re-use the exact same program to solve this task.</li>
              <li>Open the <img src="tasksmenu.png" style="height:22px; border: solid 1px #333"> menu in the task editor and drag the <img src="movestacknostation.png" style="height:30px"> block from the "Existing tasks" list onto the canvas.</li>
              <li>Attach the new task block to the very bottom of the program. Then assign it to "Station B" using the <img src="stationmenu.png" style="height:22px"> menu.</li>
              <li>Before you continue, take another moment to understand what the current program does and try it out by resetting the simulator and then clicking the <img src="runprogram.png" style="height:30px; margin:1px"> button again.</li>
            </ol>
          </li>
          <li><a href="#step3" data-toggle="collapse">Clone the existing program</a>
            <ol id="step3" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>You have now solved the first 2 steps of the given task. Step 3 is too different from the first two to re-use the existing program as it is. However, you can use the existing program as a starting point to save you some time.</li>
              <li>Open the <img src="tasksmenu.png" style="height:22px; border: solid 1px #333"> menu in the task editor and right-click on the <img src="movestacknostation.png" style="height:30px"> block in the "Existing tasks" list.</li>
              <li>Select <img src="clonetask.png" style="height:22px; border: solid 1px #333"> in the right-click menu to create an identical copy of the task. The new task should appear right underneath the existing one in the "Existing tasks" list.</li>
              <li>Drag the new task you just created onto the canvas and attach it to the very bottom of the program. Then assign it to "Station C" using the <img src="stationmenu.png" style="height:22px"> menu.</li>
              <li>Before you continue, take another moment to understand what the current program does and try it out by resetting the simulator and then clicking the <img src="runprogram.png" style="height:30px; margin:1px"> button again. As you can see, you have not yet solved step 3 of the task completely. However, you now have a starting point for adding the missing steps.</li>
            </ol>
          </li>
          <li><a href="#step4" data-toggle="collapse">Edit the cloned program</a>
            <ol id="step4" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>Make sure that you have selected the newly created task for station C in the left canvas.</li>
              <li>Open the <img src="armmenu.png" style="height:22px; border: solid 1px #333"> menu and drag the <img src="turnitem.png" style="height:30px; margin:1px"> block onto the canvas.</li>
              <li>The robot can only turn items that it is currently carrying, so the new block needs to be added in-between the blocks for picking up and placing an item. We recommend that you begin by adding the block between picking up and placing the first item in the stack.</li>
              <li>Repeat the previous steps to add a second <img src="turnitem.png" style="height:30px; margin:1px;"> block right after the previous one. Combined the two blocks will turn the item upside-down.</li>
              <li>Now repeat the previous steps to add more <img src="turnitem.png" style="height:30px; margin:1px;"> blocks for the other two items in the stack. You should have used 6 turn blocks in total in the final program.</li>
            </ol>
          </li>
          <li><a href="#step5" data-toggle="collapse">Test the program</a>
            <ol id="step5" class="collapse" data-parent="#steps" style="list-style-type: lower-alpha">
              <li>You have successfully programmed the entire task. Test your solution by clicking the button below. Watch how the robot executes each step of the program.</li>
            </ol>
          </li>
        </ol>
      <button id="test-button" value="start-test" type="button" class="btn btn-success">Test Current Program</button>
      <span id="task-fail">Task not completed! Please go back and make sure you followed all the steps correctly.</span>
      <span id="task-success">Task completed! Congratulations, you've successfully re-used programs for multiple stations!<br><strong><a style="font-size: 20pt;" id="surveylink" href="">Click here to continue.</a></strong><br>
    </span>
    </div>
    <p>Expected Result:</p>
    <img src="expected.png" style="height:110px">
  </div>
  <div class="maincontainer">
    <div id="leftdiv" class="workspace"></div>
    <div id="middlediv" class="workspace">
      <div id="animatediv" style="margin-left: 0px">
        <div id="stackedRest">
          <div id="stackedDummyDrawer"></div>
        </div>
        <div id="__Move Stackdiv" class="workspace" style="position: relative;"></div>
      </div>
    </div>
    <div id="rightdiv">
      <div id="simulatorarea">
      <div id="simulatordiv"></div>
      <button id="execution-button" value="start-execution" type="button" class="btn btn-success">Run Program</button>
      <button id="reset-button" value="reset-simulator" type="button" class="btn btn-secondary">Reset Simulator</button>
      </div>
    </div>
    <div id="output">
    </div>
    <div id="simbuttons">
    </div>
  </div>

  <!-- Starting configuration -->
  <xml xmlns="https://developers.google.com/blockly/xml" id="workspaceBlocks" style="display: none">
    <variables>
      <variable id="Move Stack">Move Stack</variable></variables>
      <block type="custom_start" id="START" x="28" y="28"><next><block type="custom_task"><field name="TASK">Move Stack</field><field name="SITE">STATIONA</field></block></next></block></xml>
  </xml>

  <xml xmlns="https://developers.google.com/blockly/xml" id="toolboxLeft" style="display: none">
    <category name="Tasks" colour="#5C9FA6" custom="TASKS">
    </category>
  </xml>

  <xml xmlns="https://developers.google.com/blockly/xml" id="toolboxRight" style="display: none">
    <category name="Arm" colour="#968e4f">
      <block type="custom_pickup">
        <value name="LOCATION">
          <shadow type="custom_dummylocation">
          </shadow>
        </value>
      </block>
      <block type="custom_place">
        <value name="LOCATION">
          <shadow type="custom_dummylocation">
          </shadow>
        </value>
      </block>
      <block type="custom_turn">
      </block>
    </category>
    <category name="Locations" colour="#A08260" custom="LOCATIONS">
    </category>
  </xml>

  <xml xmlns="https://developers.google.com/blockly/xml" id="rightWorkspaceBlocks" style="display: none">
    <variables>
      <variable id="top left">top left</variable>
      <variable id="middle left">middle left</variable>
      <variable id="bottom left">bottom left</variable>
      <variable id="top right">top right</variable>
      <variable id="middle right">middle right</variable>
      <variable id="bottom right">bottom right</variable>
    </variables>
    <block type="custom_taskheader" deletable="false" x="28" y="28"><field name="TASK">Move Stack</field><field name="SITE">STATIONA</field><next><block type="custom_pickup"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">top left</field></block></value><next><block type="custom_place"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">bottom right</field></block></value><next><block type="custom_pickup"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">middle left</field></block></value><next><block type="custom_place"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">middle right</field></block></value><next><block type="custom_pickup"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">bottom left</field></block></value><next><block type="custom_place"><value name="LOCATION"><shadow type="custom_dummylocation"></shadow><block type="custom_location"><field name="LOCATION">top right</field></block></value></block></next></block></next></block></next></block></next></block></next></block></next></block>
  </xml>

  <!-- Javascript Code -->
  <script src="task.js"></script>
  <script src="../blockly/blockly_uncompressed.js"></script>
  <script src="../blockly/blocks_compressed.js"></script>
  <script src="../blockly/javascript_compressed.js"></script>
  <script src="../js/generator.js"></script>
  <script src="../blockly/msg/js/en.js"></script>
  <script src="../js/blocks.js"></script>
  <script src="../js/index.js"></script>
  <script src="../js/twocanvas.js"></script>
  <script src="../js/simulator.js"></script>
  <script src="../js/defposition.js"></script>
</body>
</html>